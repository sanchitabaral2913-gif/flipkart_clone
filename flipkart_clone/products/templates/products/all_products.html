{% extends 'base.html' %}
{% load static %}

{% block content %}

<style>
/* ===== GRID CARD ===== */
.product-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    background: #fff;
    overflow: hidden;
    height: 100%;
    display: flex;
    flex-direction: column;
}

/* ===== IMAGE WRAPPER (ðŸ”¥ REAL FIX) ===== */
.image-wrapper {
    width: 100%;
    aspect-ratio: 1 / 1;      /* ðŸ”¥ SAME SIZE GUARANTEE */
    background: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
}

.image-wrapper img {
    width: 100%;
    height: 100%;
    object-fit: contain;      /* image cut nahi hogi */
    display: block;
}

/* ===== BODY ===== */
.card-body {
    padding: 10px;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
}

/* ===== TITLE SAME HEIGHT ===== */
.product-title {
    font-size: 14px;
    min-height: 42px;
}

/* ===== DESC SAME HEIGHT ===== */
.product-desc {
    font-size: 12px;
    color: #666;
    min-height: 60px;
    overflow: hidden;
}

/* ===== PRICE ===== */
.price {
    font-size: 18px;
    font-weight: 700;
    margin: 6px 0;
}

/* ===== BUTTONS BOTTOM FIX ===== */
.actions {
    margin-top: auto;
}
</style>
<form method="GET" class="mb-4">
    <div class="input-group">

        <!-- Search -->
        <input type="text"
               name="search"
               value="{{ request.GET.search }}"
               class="form-control"
               placeholder="Search for products, brands and more">

        <!-- Min Price -->
        <input type="number"
               name="min"
               value="{{ request.GET.min }}"
               placeholder="Min â‚¹"
               class="form-control">

        <!-- Max Price -->
        <input type="number"
               name="max"
               value="{{ request.GET.max }}"
               placeholder="Max â‚¹"
               class="form-control">

        <!-- Category -->
        <select name="category" class="form-control">
            <option value="">All Categories</option>

            {% for cat in categories %}
                <option value="{{ cat.name }}"
                    {% if request.GET.category == cat.name %}selected{% endif %}>
                    {{ cat.name }}
                </option>
            {% endfor %}
        </select>

        <button class="btn btn-primary" type="submit">
            Apply
        </button>

    </div>
</form>



<h3 class="mb-4">All Products</h3>

<div class="row">
{% for product in products %}
<div class="col-lg-3 col-md-4 col-sm-6 mb-4">

    <div class="product-card">

        <!-- IMAGE -->
        <div class="image-wrapper">
            {% if product.image_front %}
                <img src="{{ product.image_front.url }}">
            {% else %}
                <img src="{% static 'images/no-image.png' %}">
            {% endif %}
        </div>

        <!-- BODY -->
        <div class="card-body text-center">
            <div class="product-title">
                {{ product.name|truncatechars:40 }}
            </div>

            <div class="product-desc">
                {{ product.description|truncatechars:90 }}
            </div>

            <div class="price">â‚¹ {{ product.price }}</div>

            <div class="actions">
                <a href="#" class="btn btn-primary btn-sm w-100">Add to Cart</a>
                <a href="{% url 'product_detail' product.id %}"
                   class="btn btn-outline-primary btn-sm w-100 mt-1">
                   View Details
                </a>
            </div>
        </div>

    </div>

</div>
{% empty %}
<p>No products found.</p>
{% endfor %}
</div>

{% endblock %}
